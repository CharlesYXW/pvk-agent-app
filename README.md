# 钙钛矿研发智能助手 - 项目任务清单

---

## 🚀 快速开始与使用指南 (Quick Start & User Guide)

### 1. 启动Web应用

在您的终端中，确保已激活conda环境，然后运行以下命令：

```bash
conda run -n mylangchain streamlit run app.py --server.headless true
```
执行后，终端会提供一个本地URL (通常是 `http://localhost:8501`)，在浏览器中打开此地址即可使用本应用。

### 2. 更新为真实数据 (关键步骤)

为了让Agent发挥真正作用，您需要用真实数据替换掉我们用于演示的模拟数据。

#### A. 更新知识库 (用于问答)

1.  **准备文档:** 准备好您部门的研究报告、技术文档等 (我们已内置了对 `.txt` 格式的支持)。
2.  **替换文件:** 清空 `knowledge_base_docs` 文件夹中的模拟文件，将您的真实文档放入其中。
3.  **重建索引:** **必须** 重新运行一次知识库构建脚本，来让Agent学习您的新文档。
    ```bash
    conda run -n mylangchain python build_knowledge_base.py
    ```

#### B. 更新实验数据 (用于预测和优化)

1.  **准备数据:** 将您的历史实验数据整理到一个 CSV 文件中。
2.  **匹配格式:** **(重要!)** 确保CSV文件的表头与 `simulated_experimental_data.csv` 完全一致，必须包含以下列： `spin_coating_rpm,annealing_temperature_C,additive_concentration_percent,efficiency_percent`。
3.  **替换文件:** 用您的真实数据CSV文件，直接覆盖项目根目录下的 `simulated_experimental_data.csv` 文件。
4.  **完成!** 您无需任何额外操作。下次启动Web应用时，AI模型将自动使用您的真实数据进行训练和预测。

---

## 🗺️ 项目阶段规划 (Project Phase Plan)

### **第一阶段：知识核心与信息助理 (Phase 1: Knowledge Core & Information Assistant)**

这个阶段的目标是首先解决信息获取和知识管理的问题，为团队提供即时价值。

1. **知识管理系统 (Knowledge Management System):**
   
   * **功能:** 我将学习并整合您部门现有的研究报告、实验记录、工艺文件和技术know-how。您可以随时通过自然语言向我提问，例如：“查询去年所有关于电子传输层材料的实验总结”、“我们内部关于SnO2旋涂工艺的最佳参数是什么？”。
   * **技术:** 基于检索增强生成 (RAG) 技术，构建一个安全、内部的知识库。

2. **文献智能检索工具 (Intelligent Literature Retrieval):**
   
   * **功能:** 我可以根据您设定的关键词（如“钙钛矿稳定性”、“CsPbI3相变”），自动监控、抓取并总结全球最新的学术论文和专利。我可以为您生成每日或每周的“科研简报”。
   * **技术:** 连接学术数据库API（如arXiv, ACS, Wiley等），利用NLP模型进行关键信息提取和摘要生成。

**成果:** 在第一阶段结束后，您将拥有一个全天候的AI助理，它既是了解您部门所有历史工作的“老专家”，也是一个能实时追踪全球科研动态的“信息员”。

---

### **第二阶段：数据自动化与系统集成 (Phase 2: Data Automation & System Integration)**

在构建了知识核心后，我们将着手处理日常的实验数据，将您从重复性工作中解放出来。

1. **实验数据自动分析系统 (Automated Data Analysis):**
   
   * **功能:** 您只需将XRD、PL、SEM、IV曲线等测试的原始数据文件发给我，我就可以自动完成数据提取、绘图、关键参数计算（如晶格参数、缺陷态密度、填充因子等），并生成标准化的分析报告。
   * **技术:** 为每种数据格式开发专用的解析器和分析脚本，并与可视化库集成。

2. **系统集成 (System Integration):**
   
   * **功能:** 我可以与您现有的LIMS（实验室信息管理系统）或ELN（电子实验记录本）等系统进行对接，实现数据的无缝流转。
   * **技术:** 根据您现有系统的接口（API）进行定制开发。

**成果:** 第二阶段将大大缩短数据分析周期，确保分析结果的一致性和准确性，让科研人员能更专注于结果解读和实验设计。

---

### **第三阶段：智能预测与实验优化 (Phase 3: Intelligent Prediction & Experiment Optimization)**

这是最具挑战性也最具价值的阶段，我们将利用AI进行更高层次的“思考”。

1. **材料性能预测模型 (Material Property Prediction):**
   
   * **功能:** 基于历史实验数据，训练机器学习模型来预测新材料组合或新工艺参数下的性能（如光电转换效率、稳定性等）。例如：“如果我们将A材料的掺杂浓度从1%提高到1.5%，预测效率会如何变化？”
   * **技术:** 采用梯度提升树、神经网络等算法，需要大量的结构化历史数据进行训练。

2. **实验方案优化算法 (Experiment Design Optimization):**
   
   * **功能:** 基于贝叶斯优化或遗传算法，在庞大的参数空间中，智能推荐最有可能获得突破性结果的实验参数组合，从而替代传统的“试错法”，加速新配方和新工艺的发现。
   * **技术:** 这是一个闭环优化系统，它会根据新的实验结果不断学习和迭代，给出越来越好的建议。

**成果:** 第三阶段将使Agent从一个“助手”进化为一个“伙伴”，它不仅能处理数据，还能提出创造性的建议，直接驱动研发创新。

---

## 📊 整体项目进度

<!-- 进度条将根据已完成任务的比例动态更新 -->
**进度：** 83.3%
`[███████████████░░░] 5/6`

---

## 📝 任务规划区 (Task Planning Area)

以下是待办任务列表，对应上述项目阶段。

### 优先级：高 (High)

- [x] **任务 #1:** `[开发]` `[阶段一]` 构建知识管理系统 (Knowledge Management System)
- [x] **任务 #2:** `[开发]` `[阶段一]` 创建文献智能检索工具 (Intelligent Literature Retrieval)

### 优先级：中 (Medium)

- [x] **任务 #3:** `[开发]` `[阶段二]` 搭建实验数据自动分析系统 (Automated Data Analysis)
    > **[数据需求说明 - 待提供]**
    >
    > 为了让Agent能准确地自动分析实验数据，后续需要研发同事提供以下信息：
    >
    > 1.  **原始数据样本:**
    >     *   **格式:** 提供每种实验（如XRD, PL, SEM, IV曲线）的典型原始数据文件。
    *   **范例 (XRD):** 包含衍射角 (2θ) 和强度 (Intensity) 两列的文本文件 (`.txt`, `.csv`) 或标准格式 (`.xrdml`)。
    >
    > 2.  **标准分析流程:**
    >     *   **目标:** 描述手动分析这些数据时的具体步骤和目标。
    >     *   **范例 (XRD):**
    >         *   需要识别哪些关键的衍射峰 (e.g., (110), (220), (310) for Perovskite)？
    >         *   需要计算哪些参数 (e.g., 通过谢乐公式计算晶粒尺寸)？
    >         *   需要绘制什么样的图表？是否需要标注特定信息？
    >
    > *(当前开发将基于通用模拟数据进行，待以上信息明确后，可快速适配实际应用。)*
- [-] **任务 #4:** `[集成]` `[阶段二]` 对接现有研发系统 (System Integration) - *已延后*

### 优先级：低 (Low)

- [x] **任务 #5:** `[算法]` `[阶段三]` 开发材料性能预测模型 (Material Property Prediction)
- [x] **任务 #6:** `[算法]` `[阶段三]` 设计实验方案优化算法 (Experiment Design Optimization)

---

## ✅ 进度追踪区 (Progress Tracking Area)

本区域记录已完成的任务及其完成时间。

*   **任务 #1: 构建知识管理系统** - ✅ 已完成 (2025年10月16日)
*   **任务 #2: 创建文献智能检索工具** - ✅ 已完成 (2025年10月16日)
*   **任务 #3: 搭建实验数据自动分析系统** - ✅ 已完成 (2025年10月16日 - 基于模拟数据)
*   **任务 #5: 开发材料性能预测模型** - ✅ 已完成 (2025年10月16日 - 基于模拟数据)
*   **任务 #6: 设计实验方案优化算法** - ✅ 已完成 (2025年10月16日 - 基于模拟数据)

---

## 未来功能 (TODO)

- [ ] **任务 #7:** `[开发]` `[阶段一]` **实现基于全文的“深入研究”功能**
    > **功能描述:** 在文献检索结果中，为每篇论文增加一个“深入研究”按钮。点击后，AI将下载论文全文PDF，并对其进行深入分析，而不仅仅是基于摘要。
    >
    > **挑战与实现思路:**
    > 1.  **全文获取与解析:**
    >     *   **获取:** 程序需通过论文的PDF链接下载文件。
    >     *   **解析:** 需要引入PDF解析库（如 `PyPDF2`, `pdfplumber`）来提取纯文本内容。
    > 2.  **长文本处理 (核心挑战):**
    >     *   **问题:** 完整的论文通常远超大模型单次能处理的文本长度上限。
    >     *   **策略:** 采用“Map-Reduce”思想。先将论文拆分成章节或段落（Map），让AI分别概括每个部分的核心内容；然后将这些部分概括再进行一次整合，形成最终的结构化摘要（Reduce）。
    > 3.  **第一阶段实现方案 (“关键信息提取”):**
    >     *   作为第一步，可以先实现一个简化版。点击“深入研究”后，AI通读全文并结构化地提取以下关键信息，而非生成完整的自由摘要：
    >         *   **研究目标 (Objective)**
    >         *   **核心方法 (Methodology)**
    >         *   **关键结果与数据 (Key Results & Data)**
    >         *   **主要结论 (Conclusion)**
    >     *   这种方式既能提供远超摘要的深度信息，又能在技术上更快落地。

---

## 🚀 项目总结与后续步骤 (Project Summary & Next Steps)

**所有核心开发任务已全部完成！**

我们已经成功构建了“钙钛矿研发智能助手”的完整原型。这个原型具备了从信息处理到智能决策的端到端能力。

**后续步骤建议:**

1.  **数据对接:**
    *   将 `knowledge_base_docs` 中的模拟文档替换为真实的内部研究报告。
    *   用真实的实验数据替换 `simulated_experimental_data.csv` 文件。数据越多，模型的性能越好。
    *   根据 `README` 中记录的“数据需求说明”，与同事沟通，获取更详细的数据和分析流程。

2.  **模型调优:**
    *   当拥有真实数据后，我们可以重新运行 `performance_predictor.py` 和 `optimizer.py`，得到更精确、更有价值的预测和优化建议。
    *   可以尝试更先进的优化算法（如贝叶斯优化）来替代网格搜索，以提高寻找最佳参数的效率。

3.  **功能扩展:**
    *   我们可以重新审视并启动被延后的 **任务 #4**，探讨与LIMS、ELN等现有系统的集成方案。
    *   可以为更多类型的实验数据（如PL, SEM）开发专用的分析脚本。

感谢您的指导，我们共同完成了这个出色的项目原型！